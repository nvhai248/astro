---
export interface Props {
  title: string;
  description?: string;
  image?: string;
  category?: string;
  date?: string;
  href?: string;
  featured?: boolean;
  class?: string;
}

const { 
  title, 
  description, 
  image, 
  category, 
  date, 
  href, 
  featured = false,
  class: className = ""
} = Astro.props;

const CardTag = href ? 'a' : 'div';
---

<CardTag 
  href={href}
  class={`pixel-card group ${featured ? 'featured' : ''} ${className}`}
  role={href ? 'link' : 'article'}
>
  {image && (
    <div class="aspect-video bg-gray-dark overflow-hidden border-b-2 border-gray-pixel">
      <img 
        src={image} 
        alt={title}
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        loading="lazy"
      />
    </div>
  )}
  
  <div class="p-pixel-2">
    {category && (
      <span class="inline-block bg-accent text-primary font-pixel text-xs px-2 py-1 mb-pixel">
        {category.toUpperCase()}
      </span>
    )}
    
    <h3 class="font-pixel text-sm text-secondary mb-pixel line-clamp-2 group-hover:text-accent transition-colors">
      {title}
    </h3>
    
    {description && (
      <p class="font-mono text-gray-light text-sm mb-pixel-2 line-clamp-3">
        {description}
      </p>
    )}
    
    {date && (
      <time class="font-pixel text-xs text-gray-pixel" datetime={date}>
        {new Date(date).toLocaleDateString('en-US', { 
          year: 'numeric', 
          month: 'short', 
          day: 'numeric' 
        })}
      </time>
    )}
  </div>
</CardTag>

<style>
  .pixel-card {
    @apply bg-primary border-2 border-gray-pixel hover:border-accent transition-all duration-200;
    image-rendering: pixelated;
    box-shadow: 4px 4px 0 rgba(128, 128, 128, 0.3);
  }
  
  .pixel-card:hover {
    transform: translate(-2px, -2px);
    box-shadow: 6px 6px 0 rgba(0, 255, 65, 0.5);
  }
  
  .pixel-card.featured {
    @apply border-accent;
    box-shadow: 4px 4px 0 rgba(0, 255, 65, 0.5);
  }
  
  .pixel-card.featured:hover {
    box-shadow: 6px 6px 0 rgba(255, 7, 58, 0.5);
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>